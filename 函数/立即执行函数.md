## 定义
此类函数没有声明，在一次执行过后即释放。适合做初始化工作。
## 为什么会有立即执行函数？
一般情况下，被定义的函数（只有在其所在环境被创建时，函数才会被定义创建，即它所在的外部函数被执行时。参考[作用域.md](../作用域/作用域.md)），都会等待被执行，在等待过程中会占用资源，除非（？它所在的环境）js执行完了，资源才会被释放。但有些函数从出生到执行完，只会执行一次。对于这样的函数就不想将其定义成一般形式的函数。可以将其定义成“立即执行函数”。立即执行函数执行完就会被立即销毁。

> 立即执行函数是唯一一种立即销毁函数的途径。不能被反复调用，并且在执行完之后会被马上释放，除此之外，与普通函数没有任何区别。一样可以传参，一样可以有返回值，一样有预编译过程。


## 立即执行函数的写法

### 官方给出的写法
1. (function (){}());
2. (function (){})();
> 以上是官方给出的两种写法，但是W3C推荐第一种。

### 执行符号与函数的执行

只有表达式才能被执行符号执行！

----

例-1：
```javascript
function test(){
    var a =123
}();
```
例-1代码不会被执行，因为这是函数声明。

---

例-2：
```javascript
test();
```
例-2代码会被执行，因为这是表达式。就好像，只写123; 456; 这样单独写也是表达式。

所以把例-1改成函数表达式，就可以执行：

```javascript
var test = function (){
    var a =123;
}();
```

### 非官方写法的立即执行函数
因为被执行符号执行了的函数定义，如果再次试图访问或调用它（的函数名），会发现是undefined。这说明，函数被执行一次之后就被永久的放弃了。所以，这种函数在事实上就等于是立即执行函数了。
> 一个表达式被执行，有个天生的功能：忽略这个表达式的名字（或者说是忽略这个表达式的引用）。

举例：

例-3
```javascript
var test = function (){
    var a =123;
    console.log(a);
}();

console.log(test);  // undefined
test(); // Uncaught TypeError: test is not a function
```

甚至还可以这样写：例-4
```javascript
+ function test (){
    var a =123;
    console.log(a);
}();

console.log(test);  // Uncaught ReferenceError: test is not defined
test(); // Uncaught TypeError: test is not a function
```

注意：
1. 这里+（正）、-（负）、&&、||、！都可以（将函数声明变成函数表达式），但是*（乘除）、/ 不可以（也许是因为函数声明不能参与算术运算，所以那样写本身就是非法的吧）。
2. 例-3和例-4 中的log打印，一个是undefined，一个是not defined。是因为：
   - 例-3中：是在函数执行后，函数虽然被销毁了，但是变量test的声明还存在。
   - 例-4中：在函数执行完后，函数包括名字在内的所有声明和定义全被销毁，所以再想访问这个函数，甚至只是想打印名字，都是not defined。

### 函数表达式
从上面可以看出，立即执行函数其实在建立在函数表达式的基础上成立的。立即执行函数之所以执行之后立即被销毁，并且连函数名都成了undefined，是因为**表达式**本身，在执行完后就会被销毁，而并**不是只有**函数表达式才这样。只要是表达式，都是如此，有时候，哪怕函数表达式不被调用，它仍然可以看作“被执行了”。如下：
```javascript
// if语句里的f 就是函数表达式，
// 虽然没有被调用，但也可以看作“被执行了”，
// 其实本来就是执行了，只是并不是“调用”的那种执行。
// 因为可以试想，如果没有被执行的话，那么后面的代码也就同样不会被执行。
var x = 1;
if (function f() { }) { 
    x += typeof f;
}
console.log(x); // 1undefined
```


## 比较

代码一：
```javascript
function fn (a,b,c,d){
    console.log(a,b,c,d);
}();
```
vs

```javascript
function fn (a,b,c,d){
    console.log(a,b,c,d);
}(1，2，3，4);
```
执行结果：
- 代码一：连语法检查都通不过。会报错：Uncaught SyntaxError: Unexpected token )
- 代码二：不报错，但是fn方法也没有执行。

原因及两段代码的区别：这两个写法，fn都没有执行，是因为它们都是函数声明，所以不会被执行符号执行。之所以代码一会报错，而代码二不报错，是因为解释器对括号的解释不一样：
- 代码一的括号，只能被当成执行符号看待。函数声明不能被执行符号执行，所以这个写法属于语法错误。
- 而代码二中的括号，会由于系统“能不报错就不报错”的原因，而以下面的方式看待识别：

   ```javascript
   function fn (a,b,c,d){
       console.log(a,b,c,d);
   }
   
   (1，2，3，4);
   ```
   也就是说，代码二中的括号其实没有被当作是执行符号。而且test 还是test，就是普通的函数声明。


